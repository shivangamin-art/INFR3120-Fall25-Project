<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Car - AutoRent</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <section class="featured-cars">
        <div class="container">
            <h1>Edit Car Details</h1>

            <div class="form-container">
                <form id="editCarForm">

                    <!-- Hidden field to store ID -->
                    <input type="hidden" id="carId">

                    <div class="form-group">
                        <label for="model">Car Model</label>
                        <input type="text" id="model" name="model" required>
                    </div>

                    <div class="form-group">
                        <label for="type">Car Type</label>
                        <select id="type" name="type" required>
                            <option value="">Select Car Type</option>
                            <option value="Sedan">Sedan</option>
                            <option value="SUV">SUV</option>
                            <option value="Truck">Truck</option>
                            <option value="Sports Car">Sports Car</option>
                            <option value="Luxury">Luxury</option>
                            <option value="Economy">Economy</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="year">Year</label>
                        <input type="number" id="year" name="year" min="2000" max="2025" required>
                    </div>

                    <div class="form-group">
                        <label for="dailyRate">Daily Rate ($)</label>
                        <input type="number" id="dailyRate" name="dailyRate" min="1" step="0.01" required>
                    </div>

                    <div class="form-group">
                        <label for="status">Status</label>
                        <select id="status" name="status" required>
                            <option value="Available">Available</option>
                            <option value="Rented">Rented</option>
                            <option value="Maintenance">Maintenance</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="description">Description</label>
                        <textarea id="description" name="description" rows="4"></textarea>
                    </div>

                    <button type="submit" class="btn btn-primary">Update Car</button>
                    <a href="cars.html" class="btn btn-secondary">Cancel</a>
                </form>
            </div>
        </div>
    </section>

    <script>
        // Get query parameter (?id=###)
        function getQueryParam(name) {
            const params = new URLSearchParams(window.location.search);
            return params.get(name);
        }

        function loadCarForEdit() {
            const carId = getQueryParam("id");
            let cars = JSON.parse(localStorage.getItem("cars") || "[]");

            const car = cars.find(c => String(c.id) === String(carId));

            if (!car) {
                alert("Car not found.");
                window.location.href = "cars.html";
                return;
            }

            // Fill the form
            document.getElementById("carId").value = car.id;
            document.getElementById("model").value = car.model;
            document.getElementById("type").value = car.type;
            document.getElementById("year").value = car.year;
            document.getElementById("dailyRate").value = car.dailyRate;
            document.getElementById("status").value = car.status;
            document.getElementById("description").value = car.description || "";
        }

        // Update the car
        document.getElementById("editCarForm").addEventListener("submit", function (e) {
            e.preventDefault();

            const id = document.getElementById("carId").value;
            let cars = JSON.parse(localStorage.getItem("cars") || "[]");

            const index = cars.findIndex(c => String(c.id) === String(id));

            cars[index] = {
                ...cars[index],
                model: document.getElementById("model").value,
                type: document.getElementById("type").value,
                year: document.getElementById("year").value,
                dailyRate: document.getElementById("dailyRate").value,
                status: document.getElementById("status").value,
                description: document.getElementById("description").value
            };

            localStorage.setItem("cars", JSON.stringify(cars));

            alert("Car updated successfully!");
            window.location.href = "cars.html";
        });

        // Load the existing car data on page load
        loadCarForEdit();
    </script>

</body>
</html>
